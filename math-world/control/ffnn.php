<?php
$dispatcher->route('/math-world/ffnn', function() {
?><!DOCTYPE html>
<html><head>
<meta charset="utf-8">
<title></title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=AM_CHTML"></script>
</head><body>
<p>`X`は入力、`Y`は出力、`T`は訓練データの結果の縦ベクトル</p>
<p>`X`はn個の要素、`Y`はm個の要素(`T`は`Y`と同じ)、中間層はl個の要素になる</p>
<p>`Y = W_2 psi(W_1 X)`</p>
<p>`E = ||Y - T||^2 / 2`</p>

<p>`Y - T ＝ W_2 * [[psi(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n)],[psi(w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n)],[vdots],[psi(w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n)]] - T`</p>
<p>`Y - T = [
[w_(2(1,1)) psi(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n) + w_(2(1,2)) psi(w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n) + ... + w_(2(1,l)) psi(w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n) - t_1],
[w_(2(2,1)) psi(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n) + w_(2(2,2)) psi(w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n) + ... + w_(2(2,l)) psi(w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n) - t_2],
[vdots],
[w_(2(m,1)) psi(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n) + w_(2(m,2)) psi(w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n) + ... + w_(2(m,l)) psi(w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n) - t_m]]`</p>

<p>`E = (
[w_(2(1,1)) psi(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n) + w_(2(1,2)) psi(w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n) + ... + w_(2(1,l)) psi(w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n) - t_1]^2 +
[w_(2(2,1)) psi(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n) + w_(2(2,2)) psi(w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n) + ... + w_(2(2,l)) psi(w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n) - t_2]^2 +
cdots +
[w_(2(m,1)) psi(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n) + w_(2(m,2)) psi(w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n) + ... + w_(2(m,l)) psi(w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n) - t_m]^2) / 2`</p>

<p>`E = 
[w_(2(1,1)) psi(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n) + w_(2(1,2)) psi(w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n) + ... + w_(2(1,l)) psi(w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n) - t_1]^2 / 2 +
[w_(2(2,1)) psi(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n) + w_(2(2,2)) psi(w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n) + ... + w_(2(2,l)) psi(w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n) - t_2]^2 / 2 +
cdots +
[w_(2(m,1)) psi(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n) + w_(2(m,2)) psi(w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n) + ... + w_(2(m,l)) psi(w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n) - t_m]^2 / 2`</p>

<p>`(del E)/(del W_1) = [
[
	[w_(2(1,1)) psi(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n) + w_(2(1,2)) psi(w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n) + ... + w_(2(1,l)) psi(w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n) - t_1] w_(2(1,1)) psi'(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n) x_1 + 
	[w_(2(2,1)) psi(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n) + w_(2(2,2)) psi(w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n) + ... + w_(2(2,l)) psi(w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n) - t_2] w_(2(2,1)) psi'(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n) x_1 +
	cdots +
	[w_(2(m,1)) psi(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n) + w_(2(m,2)) psi(w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n) + ... + w_(2(m,l)) psi(w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n) - t_m] w_(2(m,1)) psi'(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n) x_1,

	cdots
],
[vdots, ddots]]`</p>

<p>`{
([Y - T]_1 = [w_(2(1,1)) psi(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n) + w_(2(1,2)) psi(w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n) + ... + w_(2(1,l)) psi(w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n) - t_1]),
([Y - T]_2 = [w_(2(2,1)) psi(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n) + w_(2(2,2)) psi(w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n) + ... + w_(2(2,l)) psi(w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n) - t_2]),
(vdots),
([Y - T]_m = [w_(2(m,1)) psi(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n) + w_(2(m,2)) psi(w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n) + ... + w_(2(m,l)) psi(w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n) - t_m]):}`</p>

<p>`(del E)/(del W_1) = [
[
	{[Y - T]_1 w_(2(1,1)) +
	 [Y - T]_2 w_(2(2,1)) +
	 cdots +
	 [Y - T]_m w_(2(m,1))} psi'(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n) x_1,
	
	{[Y - T]_1 w_(2(1,1)) +
	 [Y - T]_2 w_(2(2,1)) +
	 cdots +
	 [Y - T]_m w_(2(m,1))} psi'(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n) x_2,
	 
	cdots,
	 
	{[Y - T]_1 w_(2(1,1)) +
	 [Y - T]_2 w_(2(2,1)) +
	 cdots +
	 [Y - T]_m w_(2(m,1))} psi'(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n) x_n
],
[
	{[Y - T]_1 w_(2(1,2)) +
	 [Y - T]_2 w_(2(2,2)) +
	 cdots +
	 [Y - T]_m w_(2(m,2))} psi'(w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n) x_1,
	
	{[Y - T]_1 w_(2(1,2)) +
	 [Y - T]_2 w_(2(2,2)) +
	 cdots +
	 [Y - T]_m w_(2(m,2))} psi'(w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n) x_2,
	 
	cdots,
	 
	{[Y - T]_1 w_(2(1,2)) +
	 [Y - T]_2 w_(2(2,2)) +
	 cdots +
	 [Y - T]_m w_(2(m,2))} psi'(w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n) x_n
],
[vdots,vdots,ddots,vdots],
[
	{[Y - T]_1 w_(2(1,l)) +
	 [Y - T]_2 w_(2(2,l)) +
	 cdots +
	 [Y - T]_m w_(2(m,l))} psi'(w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n) x_1,
	
	{[Y - T]_1 w_(2(1,l)) +
	 [Y - T]_2 w_(2(2,l)) +
	 cdots +
	 [Y - T]_m w_(2(m,l))} psi'(w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n) x_2,
	 
	cdots,
	 
	{[Y - T]_1 w_(2(1,l)) +
	 [Y - T]_2 w_(2(2,l)) +
	 cdots +
	 [Y - T]_m w_(2(m,l))} psi'(w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n) x_n
]
]`</p>

<p>`(del E)/(del W_1) = [
[
	{[Y - T]_1 w_(2(1,1)) +
	 [Y - T]_2 w_(2(2,1)) +
	 cdots +
	 [Y - T]_m w_(2(m,1))} psi'(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n)
],
[
	{[Y - T]_1 w_(2(1,2)) +
	 [Y - T]_2 w_(2(2,2)) +
	 cdots +
	 [Y - T]_m w_(2(m,2))} psi'(w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n)
],
[vdots],
[
	{[Y - T]_1 w_(2(1,l)) +
	 [Y - T]_2 w_(2(2,l)) +
	 cdots +
	 [Y - T]_m w_(2(m,l))} psi'(w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n)
]
] [[x_1, x_2, cdots, x_n]]`</p>

<p>`(del E)/(del W_1) = ([
    [
    	[Y - T]_1 w_(2(1,1)) +
    	[Y - T]_2 w_(2(2,1)) +
    	cdots +
    	[Y - T]_m w_(2(m,1))
    ],
    [
    	[Y - T]_1 w_(2(1,2)) +
    	[Y - T]_2 w_(2(2,2)) +
    	cdots +
    	[Y - T]_m w_(2(m,2)) 
    ],
    [vdots],
    [
    	[Y - T]_1 w_(2(1,l)) +
    	[Y - T]_2 w_(2(2,l)) +
    	cdots +
    	[Y - T]_m w_(2(m,l)) 
    ]
] @ [
	[
	 	psi'(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n)
	],
	[
	 	psi'(w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n)
	],
	[vdots],
	[
	 	psi'(w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n)
	]
]) [[x_1, x_2, cdots, x_n]]
`</p>
<p>`
[Y - T]^t W_2 = [[
	[Y - T]_1 w_(2(1,1)) +
	[Y - T]_2 w_(2(2,1)) +
	cdots +
	[Y - T]_m w_(2(m,1)),
	
	[Y - T]_1 w_(2(1,2)) +
	[Y - T]_2 w_(2(2,2)) +
	cdots +
	[Y - T]_m w_(2(m,2)),
	
	cdots,
	
	[Y - T]_1 w_(2(1,l)) +
	[Y - T]_2 w_(2(2,l)) +
	cdots +
	[Y - T]_m w_(2(m,l)) 
]]
`</p>
<p>`(del E)/(del W_1) = (((Y - T)^t W_2)^t @ [
	[
	 	psi'(w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n)
	],
	[
	 	psi'(w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n)
	],
	[vdots],
	[
	 	psi'(w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n)
	]
]) [[x_1,x_2,cdots,x_n]]
`</p>

<p>`(del E)/(del W_1) = (((Y - T)^t W_2)^t @ psi'(
[
	[w_(1(1,1)) x_1 + w_(1(1,2)) x_2 + ... + w_(1(1,n)) x_n],
	[w_(1(2,1)) x_1 + w_(1(2,2)) x_2 + ... + w_(1(2,n)) x_n],
	[vdots],
	[w_(1(l,1)) x_1 + w_(1(l,2)) x_2 + ... + w_(1(l,n)) x_n]
])) [[x_1,x_2,cdots,x_n]]
`</p>

<p>`(del E)/(del W_1) = (((Y - T)^t W_2)^t @ psi'(W_1 X)) [[x_1,x_2,cdots,x_n]]`</p>

<p>`(del E)/(del W_1) = (((Y - T)^t W_2)^t @ psi'(W_1 X)) X^t`</p>

</body></html>
<?php
});
